<div class="container mx-auto px-4 sm:px-4 pt-2 md:pt-8">
  <div class="flex flex-col justify-between items-start mb-4 sm:mb-6">
    <h1 class="text-4xl sm:text-5xl font-steven mb-0">Activity Feed</h1>
  </div>

  <% if @followed_projects.any? %>
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-4 sm:gap-8 pt-2">
      <div class="lg:col-span-1">
        <div class="bg-soft-bone card-pixel p-4 sm:p-6 sticky top-4">
          <h2 class="text-2xl sm:text-3xl 2xl:text-4xl font-steven mb-4 sm:mb-6">Projects You Follow</h2>
          <div class="space-y-3 sm:space-y-4 max-h-[calc(100vh-12rem)] overflow-y-auto pr-2">
            <% @followed_projects.each do |project| %>
              <div class="transform transition-transform duration-300">
                <div class="flex items-center space-x-2 sm:space-x-4">
                  <div class="h-12 w-12 sm:h-16 sm:w-16 overflow-hidden rounded-lg flex-shrink-0">
                    <img src="<%= project.banner %>" alt="<%= project.title %>" class="w-full h-full object-cover">
                  </div>
                  <div class="flex-grow min-w-0">
                    <h3 class="text-lg sm:text-xl 2xl:text-2xl font-steven truncate"><%= project.title %></h3>
                    <p class="text-gray-600 line-clamp-2 text-xs sm:text-sm 2xl:text-base"><%= project.description %></p>
                  </div>
                  <%= link_to project_path(project), class: "px-3 sm:px-4 py-1.5 sm:py-2 bg-forest hover:scale-[1.05] text-white transition-transform duration-300 text-base sm:text-lg 2xl:text-xl btn-pixel flex-shrink-0" do %>
                    View
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>

      <div class="lg:col-span-2">
        <div class="bg-soft-bone card-pixel p-4 sm:p-6">
          <h2 class="text-2xl sm:text-3xl 2xl:text-4xl font-steven mb-4 sm:mb-6">Recent Updates</h2>
          <div class="space-y-4 sm:space-y-6">
            <% @recent_updates.each do |update| %>
              <div class="transform transition-transform duration-300 mb-4 sm:mb-6">
                <div class="flex items-center mb-2 sm:mb-3">
                  <% if update.user.avatar.present? %>
                    <img src="<%= update.user.avatar %>" alt="<%= update.user.display_name %>" class="w-8 h-8 sm:w-10 sm:h-10 rounded-full mr-2 sm:mr-3">
                  <% end %>
                  <div>
                    <span class="font-medium text-base sm:text-lg 2xl:text-xl"><%= update.user.display_name %></span>
                    <span class="text-gray-600 text-xs sm:text-sm 2xl:text-base ml-2"><%= time_ago_in_words(update.created_at) %> ago</span>
                  </div>
                </div>
                <div class="ml-10 sm:ml-13">
                  <h3 class="text-lg sm:text-xl 2xl:text-2xl font-steven mb-2"><%= update.project.title %></h3>
                  <p class="text-gray-600 mb-2 sm:mb-3 text-sm sm:text-base 2xl:text-lg"><%= update.text %></p>
                  <% if update.attachment.present? %>
                    <div class="mt-2 sm:mt-3 overflow-hidden rounded-lg">
                      <img src="<%= update.attachment %>" alt="Update attachment" class="w-full h-48 sm:h-64 object-contain cursor-pointer hover:opacity-90 transition-opacity" data-action="click->image-viewer#open">
                    </div>
                  <% end %>
                  <%= link_to project_path(update.project), class: "mt-2 sm:mt-3 inline-block px-3 sm:px-4 py-1.5 sm:py-2 bg-nice-blue hover:scale-[1.05] text-white transition-transform duration-300 text-base sm:text-lg 2xl:text-xl btn-pixel" do %>
                    View Project
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  <% else %>
    <div class="bg-soft-bone card-pixel p-6 sm:p-12 text-center">
      <h2 class="text-xl sm:text-2xl 2xl:text-3xl font-steven mb-3 sm:mb-4">No Activity Yet</h2>
      <p class="mb-6 sm:mb-8 text-gray-600 text-sm sm:text-base 2xl:text-lg">Start following some projects to see their updates here!</p>
      <%= link_to explore_path, class: "px-4 sm:px-6 py-2 sm:py-3 bg-forest hover:scale-[1.05] text-white transition-transform duration-300 text-base sm:text-lg 2xl:text-xl btn-pixel" do %>
        Explore Projects
      <% end %>
    </div>
  <% end %>
</div>
